import { Injectable } from '@nestjs/common';
import * as nodemailer from 'nodemailer';
import { AdmissionEmailData } from './email-queue.service';

@Injectable()
export class EmailService {
  private transporter: nodemailer.Transporter;

  constructor() {
    this.transporter = nodemailer.createTransport({
      host: process.env.EMAIL_HOST || process.env.SMTP_HOST,
      port: parseInt(process.env.EMAIL_PORT || process.env.SMTP_PORT || '587', 10),
      secure: process.env.EMAIL_SECURE === 'true' || process.env.SMTP_SECURE === 'true',
      auth: {
        user: process.env.EMAIL_USER || process.env.SMTP_USER,
        pass: process.env.EMAIL_PASSWORD || process.env.SMTP_PASSWORD,
      },
    });
  }

  async sendAdmissionResultEmail(
    to: string,
    data: AdmissionEmailData,
  ): Promise<void> {
    const subject = 'K·∫øt qu·∫£ x√©t tuy·ªÉn - Admission Result';
    const html = this.generateAdmissionEmailTemplate(data);

    await this.transporter.sendMail({
      from: process.env.EMAIL_FROM || process.env.SMTP_FROM || 'noreply@admission.edu.vn',
      to,
      subject,
      html,
    });
  }

  private generateAdmissionEmailTemplate(data: AdmissionEmailData): string {
    // Generate different templates based on admission status
    if (data.isAdmitted) {
      return this.generateAdmittedTemplate(data);
    } else {
      return this.generateNotAdmittedTemplate(data);
    }
  }

  private generateAdmittedTemplate(data: AdmissionEmailData): string {
    return `
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>K·∫øt qu·∫£ x√©t tuy·ªÉn</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .email-container {
      max-width: 650px;
      margin: 0 auto;
      background-color: #ffffff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .header {
      background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    .header h1 {
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .header p {
      font-size: 14px;
      opacity: 0.95;
      font-style: italic;
    }
    .content {
      padding: 40px 30px;
    }
    .greeting {
      font-size: 16px;
      margin-bottom: 20px;
      color: #333;
    }
    .result-box {
      background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
      border-left: 5px solid #4caf50;
      padding: 25px;
      margin: 25px 0;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .result-box h2 {
      font-size: 22px;
      color: #2e7d32;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .result-box p {
      font-size: 15px;
      color: #1b5e20;
      margin: 5px 0;
    }
    .info-section {
      margin: 30px 0;
    }
    .info-section h3 {
      font-size: 18px;
      color: #0066cc;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e0e0e0;
    }
    .info-row {
      display: flex;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .info-row:last-child {
      border-bottom: none;
    }
    .label {
      font-weight: 600;
      color: #555;
      min-width: 200px;
      flex-shrink: 0;
    }
    .value {
      color: #000;
      font-weight: 500;
    }
    .important-note {
      background-color: #fff3cd;
      border-left: 5px solid #ffc107;
      padding: 20px;
      margin: 30px 0;
      border-radius: 6px;
    }
    .important-note h4 {
      font-size: 16px;
      color: #856404;
      margin-bottom: 12px;
      font-weight: 700;
    }
    .important-note ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    .important-note li {
      margin: 8px 0;
      color: #856404;
      font-size: 14px;
    }
    .contact-info {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin: 25px 0;
    }
    .contact-info h4 {
      font-size: 16px;
      color: #333;
      margin-bottom: 12px;
    }
    .contact-item {
      display: flex;
      align-items: center;
      margin: 10px 0;
      font-size: 14px;
      color: #555;
    }
    .contact-item strong {
      min-width: 100px;
      color: #0066cc;
    }
    .signature {
      margin-top: 35px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }
    .signature p {
      margin: 5px 0;
      font-size: 15px;
    }
    .signature strong {
      color: #0066cc;
      font-size: 16px;
    }
    .footer {
      background-color: #f8f9fa;
      padding: 25px 30px;
      text-align: center;
      font-size: 13px;
      color: #666;
      border-top: 1px solid #e0e0e0;
    }
    .footer p {
      margin: 5px 0;
    }
    .divider {
      height: 2px;
      background: linear-gradient(to right, transparent, #0066cc, transparent);
      margin: 25px 0;
    }
    @media only screen and (max-width: 600px) {
      .email-container {
        border-radius: 0;
      }
      .content {
        padding: 25px 20px;
      }
      .info-row {
        flex-direction: column;
      }
      .label {
        min-width: auto;
        margin-bottom: 4px;
      }
    }
  </style>
</head>
<body>
  <div class="email-container">
    <div class="header">
      <h1>üéì Th√¥ng B√°o K·∫øt Qu·∫£ X√©t Tuy·ªÉn</h1>
      </div>
    
    <div class="content">
      <div class="greeting">
        <p><strong>K√≠nh g·ª≠i:</strong> ${data.studentName}</p>
        </div>
      
      <p style="margin: 20px 0; font-size: 15px; line-height: 1.8;">
        Tr∆∞·ªùng ƒê·∫°i h·ªçc xin tr√¢n tr·ªçng th√¥ng b√°o k·∫øt qu·∫£ x√©t tuy·ªÉn c·ªßa b·∫°n. 
        Ch√∫ng t√¥i r·∫•t vui m·ª´ng ƒë∆∞·ª£c ch√†o ƒë√≥n b·∫°n gia nh·∫≠p c·ªông ƒë·ªìng sinh vi√™n c·ªßa ch√∫ng t√¥i.
      </p>
      
      <div class="result-box">
        <h2>
          <span style="font-size: 28px;">üéâ</span>
          <span>CH√öC M·ª™NG! CONGRATULATIONS!</span>
        </h2>
        <p style="font-size: 16px; font-weight: 600; margin-top: 10px;">
          B·∫°n ƒë√£ TR√öNG TUY·ªÇN v√†o ch∆∞∆°ng tr√¨nh ƒë√†o t·∫°o c·ªßa tr∆∞·ªùng ch√∫ng t√¥i!
        </p>
        <p style="font-size: 14px; margin-top: 5px;">
          </div>
      
      <div class="divider"></div>
      
      <div class="info-section">
        <h3>üìã Th√¥ng tin tr√∫ng tuy·ªÉn</h3>
        
        <div class="info-row">
          <span class="label">üéØ Ng√†nh h·ªçc / Major:</span>
          <span class="value">${data.majorName}</span>
        </div>
        
        <div class="info-row">
          <span class="label">üìù Ph∆∞∆°ng th·ª©c x√©t tuy·ªÉn:</span>
          <span class="value">${this.formatAdmissionMethod(data.admissionMethod)}</span>
        </div>
        
        <div class="info-row">
          <span class="label">‚≠ê Nguy·ªán v·ªçng tr√∫ng tuy·ªÉn:</span>
          <span class="value">Nguy·ªán v·ªçng ${data.preference} (NV${data.preference})</span>
        </div>
        
        <div class="info-row">
          <span class="label">üìä ƒêi·ªÉm x√©t tuy·ªÉn / Score:</span>
          <span class="value" style="color: #4caf50; font-size: 18px; font-weight: 700;">${data.finalScore.toFixed(2)}</span>
        </div>
      </div>
      
      <div class="important-note">
        <h4>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng</h4>
        <ul>
          <li><strong>X√°c nh·∫≠n nh·∫≠p h·ªçc:</strong> Vui l√≤ng x√°c nh·∫≠n nh·∫≠p h·ªçc theo h∆∞·ªõng d·∫´n tr√™n website c·ªßa tr∆∞·ªùng trong v√≤ng 7 ng√†y k·ªÉ t·ª´ ng√†y nh·∫≠n email n√†y.</li>
          <li><strong>Enrollment Confirmation:</strong> <li><strong>N·ªôp h·ªì s∆°:</strong> Chu·∫©n b·ªã v√† n·ªôp ƒë·∫ßy ƒë·ªß h·ªì s∆° nh·∫≠p h·ªçc theo y√™u c·∫ßu.</li>
          <li><strong>Document Submission:</strong> Prepare and submit all required enrollment documents.</li>
          <li><strong>H·∫°n ch√≥t:</strong> Vui l√≤ng ki·ªÉm tra th√¥ng b√°o ch√≠nh th·ª©c tr√™n website ƒë·ªÉ bi·∫øt c√°c m·ªëc th·ªùi gian quan tr·ªçng.</li>
          <li><strong>Deadline:</strong> Please check the official announcement on our website for important dates.</li>
        </ul>
      </div>
      
      <div class="contact-info">
        <h4>üìû Th√¥ng tin li√™n h·ªá</h4>
        <div class="contact-item">
          <strong>üìß Email:</strong>
          <span>tuyensinh@utc2.edu.vn</span>
        </div>
        <div class="contact-item">
          <strong>‚òéÔ∏è ƒêi·ªán tho·∫°i:</strong>
          <span>(028) 3512 0808</span>
        </div>
        <div class="contact-item">
          <strong>üè¢ ƒê·ªãa ch·ªâ:</strong>
          <span>Ph√≤ng Tuy·ªÉn sinh, T√≤a nh√† A, Tr∆∞·ªùng ƒê·∫°i h·ªçc</span>
        </div>
        <div class="contact-item">
          <strong>üåê Website:</strong>
          <span>https://utc2.edu.vn</span>
        </div>
      </div>
      
      <div class="signature">
        <p>M·ªôt l·∫ßn n·ªØa, ch√∫c m·ª´ng b·∫°n ƒë√£ tr√∫ng tuy·ªÉn!</p>
        <p><p style="margin-top: 20px;">Tr√¢n tr·ªçng,</p>
        <p><strong>Ban Tuy·ªÉn sinh</strong></p>
        <p style="font-style: italic; color: #666;"></div>
    </div>
    
    <div class="footer">
      <p><strong>‚ö° Email t·ª± ƒë·ªông / Email t? d?ng</strong></p>
      <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng. Vui l√≤ng kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp email n√†y.</p>
      <p><p style="margin-top: 15px; color: #999;">¬© 2026 University Admission System. B?n quy?n thu?c v?.</p>
    </div>
  </div>
</body>
</html>
    `;
  }

  private generateNotAdmittedTemplate(data: AdmissionEmailData): string {
    return `
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>K·∫øt qu·∫£ x√©t tuy·ªÉn</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .email-container {
      max-width: 650px;
      margin: 0 auto;
      background-color: #ffffff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .header {
      background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    .header h1 {
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .header p {
      font-size: 14px;
      opacity: 0.95;
      font-style: italic;
    }
    .content {
      padding: 40px 30px;
    }
    .greeting {
      font-size: 16px;
      margin-bottom: 20px;
      color: #333;
    }
    .result-box {
      background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
      border-left: 5px solid #ff9800;
      padding: 25px;
      margin: 25px 0;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .result-box h2 {
      font-size: 22px;
      color: #e65100;
      margin-bottom: 12px;
    }
    .result-box p {
      font-size: 15px;
      color: #bf360c;
      margin: 5px 0;
    }
    .info-section {
      margin: 30px 0;
    }
    .info-section h3 {
      font-size: 18px;
      color: #0066cc;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e0e0e0;
    }
    .encouragement-box {
      background-color: #e3f2fd;
      border-left: 5px solid #2196f3;
      padding: 20px;
      margin: 30px 0;
      border-radius: 6px;
    }
    .encouragement-box h4 {
      font-size: 16px;
      color: #1565c0;
      margin-bottom: 12px;
      font-weight: 700;
    }
    .encouragement-box ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    .encouragement-box li {
      margin: 8px 0;
      color: #0d47a1;
      font-size: 14px;
    }
    .contact-info {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin: 25px 0;
    }
    .contact-info h4 {
      font-size: 16px;
      color: #333;
      margin-bottom: 12px;
    }
    .contact-item {
      display: flex;
      align-items: center;
      margin: 10px 0;
      font-size: 14px;
      color: #555;
    }
    .contact-item strong {
      min-width: 100px;
      color: #0066cc;
    }
    .signature {
      margin-top: 35px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }
    .signature p {
      margin: 5px 0;
      font-size: 15px;
    }
    .signature strong {
      color: #0066cc;
      font-size: 16px;
    }
    .footer {
      background-color: #f8f9fa;
      padding: 25px 30px;
      text-align: center;
      font-size: 13px;
      color: #666;
      border-top: 1px solid #e0e0e0;
    }
    .footer p {
      margin: 5px 0;
    }
    .divider {
      height: 2px;
      background: linear-gradient(to right, transparent, #0066cc, transparent);
      margin: 25px 0;
    }
    @media only screen and (max-width: 600px) {
      .email-container {
        border-radius: 0;
      }
      .content {
        padding: 25px 20px;
      }
    }
  </style>
</head>
<body>
  <div class="email-container">
    <div class="header">
      <h1>üéì Th√¥ng B√°o K·∫øt Qu·∫£ X√©t Tuy·ªÉn</h1>
      </div>
    
    <div class="content">
      <div class="greeting">
        <p><strong>K√≠nh g·ª≠i:</strong> ${data.studentName}</p>
        </div>
      
      <p style="margin: 20px 0; font-size: 15px; line-height: 1.8;">
        Tr∆∞·ªùng ƒê·∫°i h·ªçc xin tr√¢n tr·ªçng th√¥ng b√°o k·∫øt qu·∫£ x√©t tuy·ªÉn c·ªßa b·∫°n cho ƒë·ª£t tuy·ªÉn sinh n√†y.
      </p>
      
      <div class="result-box">
        <h2>üìã K·∫øt qu·∫£ x√©t tuy·ªÉn</h2>
        <p style="font-size: 15px; margin-top: 10px;">
          R·∫•t ti·∫øc, b·∫°n ch∆∞a ƒë·∫°t ƒëi·ªÅu ki·ªán tr√∫ng tuy·ªÉn trong ƒë·ª£t tuy·ªÉn sinh n√†y.
        </p>
        <p style="font-size: 14px; margin-top: 5px;">
          </div>
      
      <div class="divider"></div>
      
      <div class="encouragement-box">
        <h4>üí™ ƒê·ª´ng n·∫£n l√≤ng! / Don't Give Up!</h4>
        <p style="margin-bottom: 10px; color: #0d47a1;">
          Ch√∫ng t√¥i khuy·∫øn kh√≠ch b·∫°n xem x√©t c√°c l·ª±a ch·ªçn sau:
        </p>
        <ul>
          <li><strong>ƒêƒÉng k√Ω c√°c ng√†nh kh√°c:</strong> Nhi·ªÅu ng√†nh v·∫´n c√≤n ch·ªâ ti√™u tuy·ªÉn sinh. H√£y xem x√©t c√°c ng√†nh ph√π h·ª£p v·ªõi nƒÉng l·ª±c v√† s·ªü th√≠ch c·ªßa b·∫°n.</li>
          <li><strong>Consider other programs:</strong> Many programs still have available slots. Consider programs that match your abilities and interests.</li>
          <li><strong>ƒê·ª£t tuy·ªÉn sinh ti·∫øp theo:</strong> Chu·∫©n b·ªã t·ªët h∆°n v√† ƒëƒÉng k√Ω l·∫°i trong ƒë·ª£t tuy·ªÉn sinh ti·∫øp theo.</li>
          <li><strong>Next admission round:</strong> Prepare better and apply again in the <li><strong>T∆∞ v·∫•n tr·ª±c ti·∫øp:</strong> Li√™n h·ªá ph√≤ng tuy·ªÉn sinh ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n chi ti·∫øt v·ªÅ c√°c l·ª±a ch·ªçn ph√π h·ª£p.</li>
          <li><strong>Direct consultation:</strong> Contact the Training Department - University of Transport and Communications in Ho Chi Minh City for detailed advice on suitable options.</li>
        </ul>
      </div>
      
      <div class="contact-info">
        <h4>üìû Th√¥ng tin li√™n h·ªá</h4>
        <div class="contact-item">
          <strong>üìß Email:</strong>
          <span>tuyensinh@utc2.edu.vn</span>
        </div>
        <div class="contact-item">
          <strong>‚òéÔ∏è ƒêi·ªán tho·∫°i:</strong>
          <span>(028) 3512 0808</span>
        </div>
        <div class="contact-item">
          <strong>üè¢ ƒê·ªãa ch·ªâ:</strong>
          <span>Ph√≤ng Tuy·ªÉn sinh, T√≤a nh√† A, Tr∆∞·ªùng ƒê·∫°i h·ªçc</span>
        </div>
        <div class="contact-item">
          <strong>üåê Website:</strong>
          <span>https://utc2.edu.vn</span>
        </div>
        <div class="contact-item">
          <strong>‚è∞ Gi·ªù l√†m vi·ªác:</strong>
          <span>Th·ª© 2 - Th·ª© 6: 8:00 - 17:00</span>
        </div>
      </div>
      
      <div class="signature">
        <p>Ch√∫ng t√¥i ch√∫c b·∫°n th√†nh c√¥ng trong t∆∞∆°ng lai!</p>
        <p style="margin-top: 20px;">Tr√¢n tr·ªçng,</p>
        <p><strong>Ban Tuy·ªÉn sinh</strong></p>
        <p style="font-style: italic; color: #666;">University Admission Office</p>
      </div>
    </div>
    
    <div class="footer">
      <p><strong>‚ö° Email t·ª± ƒë·ªông / Automated Email</strong></p>
      <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng. Vui l√≤ng kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp email n√†y.</p>
      <p style="margin-top: 15px; color: #999;">¬© 2026 University Admission System. All rights reserved.</p>
    </div>
  </div>
</body>
</html>
    `;
  }

  private generateAdmittedEmailTemplate(data: any): string {
    return `
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>K·∫øt qu·∫£ x√©t tuy·ªÉn</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f5f5;
      padding: 20px;
    }
    .email-container {
      max-width: 650px;
      margin: 0 auto;
      background-color: #ffffff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .header {
      background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    .header h1 {
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .header p {
      font-size: 14px;
      opacity: 0.95;
      font-style: italic;
    }
    .content {
      padding: 40px 30px;
    }
    .greeting {
      font-size: 16px;
      margin-bottom: 20px;
      color: #333;
    }
    .result-box {
      background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
      border-left: 5px solid #4caf50;
      padding: 25px;
      margin: 25px 0;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .result-box h2 {
      font-size: 22px;
      color: #2e7d32;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .result-box p {
      font-size: 15px;
      color: #1b5e20;
      margin: 5px 0;
    }
    .info-section {
      margin: 30px 0;
    }
    .info-section h3 {
      font-size: 18px;
      color: #0066cc;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e0e0e0;
    }
    .info-row {
      display: flex;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .info-row:last-child {
      border-bottom: none;
    }
    .label {
      font-weight: 600;
      color: #555;
      min-width: 200px;
      flex-shrink: 0;
    }
    .value {
      color: #000;
      font-weight: 500;
    }
    .important-note {
      background-color: #fff3cd;
      border-left: 5px solid #ffc107;
      padding: 20px;
      margin: 30px 0;
      border-radius: 6px;
    }
    .important-note h4 {
      font-size: 16px;
      color: #856404;
      margin-bottom: 12px;
      font-weight: 700;
    }
    .important-note ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    .important-note li {
      margin: 8px 0;
      color: #856404;
      font-size: 14px;
    }
    .contact-info {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin: 25px 0;
    }
    .contact-info h4 {
      font-size: 16px;
      color: #333;
      margin-bottom: 12px;
    }
    .contact-item {
      display: flex;
      align-items: center;
      margin: 10px 0;
      font-size: 14px;
      color: #555;
    }
    .contact-item strong {
      min-width: 100px;
      color: #0066cc;
    }
    .signature {
      margin-top: 35px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }
    .signature p {
      margin: 5px 0;
      font-size: 15px;
    }
    .signature strong {
      color: #0066cc;
      font-size: 16px;
    }
    .footer {
      background-color: #f8f9fa;
      padding: 25px 30px;
      text-align: center;
      font-size: 13px;
      color: #666;
      border-top: 1px solid #e0e0e0;
    }
    .footer p {
      margin: 5px 0;
    }
    .divider {
      height: 2px;
      background: linear-gradient(to right, transparent, #0066cc, transparent);
      margin: 25px 0;
    }
    @media only screen and (max-width: 600px) {
      .email-container {
        border-radius: 0;
      }
      .content {
        padding: 25px 20px;
      }
      .info-row {
        flex-direction: column;
      }
      .label {
        min-width: auto;
        margin-bottom: 4px;
      }
    }
  </style>
</head>
<body>
  <div class="email-container">
    <div class="header">
      <h1>üéì Th√¥ng B√°o K·∫øt Qu·∫£ X√©t Tuy·ªÉn</h1>
      </div>
    
    <div class="content">
      <div class="greeting">
        <p><strong>K√≠nh g·ª≠i:</strong> ${data.studentName}</p>
        </div>
      
      <p style="margin: 20px 0; font-size: 15px; line-height: 1.8;">
        Tr∆∞·ªùng ƒê·∫°i h·ªçc xin tr√¢n tr·ªçng th√¥ng b√°o k·∫øt qu·∫£ x√©t tuy·ªÉn c·ªßa b·∫°n. 
        Ch√∫ng t√¥i r·∫•t vui m·ª´ng ƒë∆∞·ª£c ch√†o ƒë√≥n b·∫°n gia nh·∫≠p c·ªông ƒë·ªìng sinh vi√™n c·ªßa ch√∫ng t√¥i.
      </p>
      
      <div class="result-box">
        <h2>
          <span style="font-size: 28px;">üéâ</span>
          <span>CH√öC M·ª™NG! CONGRATULATIONS!</span>
        </h2>
        <p style="font-size: 16px; font-weight: 600; margin-top: 10px;">
          B·∫°n ƒë√£ TR√öNG TUY·ªÇN v√†o ch∆∞∆°ng tr√¨nh ƒë√†o t·∫°o c·ªßa tr∆∞·ªùng ch√∫ng t√¥i!
        </p>
        <p style="font-size: 14px; margin-top: 5px;">
          </div>
      
      <div class="divider"></div>
      
      <div class="info-section">
        <h3>üìã Th√¥ng tin tr√∫ng tuy·ªÉn</h3>
        
        <div class="info-row">
          <span class="label">üéØ Ng√†nh h·ªçc / Major:</span>
          <span class="value">${data.majorName}</span>
        </div>
        
        <div class="info-row">
          <span class="label">üìù Ph∆∞∆°ng th·ª©c x√©t tuy·ªÉn:</span>
          <span class="value">${this.formatAdmissionMethod(data.admissionMethod)}</span>
        </div>
        
        <div class="info-row">
          <span class="label">‚≠ê Nguy·ªán v·ªçng tr√∫ng tuy·ªÉn:</span>
          <span class="value">Nguy·ªán v·ªçng ${data.preference} (NV${data.preference})</span>
        </div>
        
        <div class="info-row">
          <span class="label">üìä ƒêi·ªÉm x√©t tuy·ªÉn / Score:</span>
          <span class="value" style="color: #4caf50; font-size: 18px; font-weight: 700;">${data.finalScore.toFixed(2)}</span>
        </div>
      </div>
      
      <div class="important-note">
        <h4>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng</h4>
        <ul>
          <li><strong>X√°c nh·∫≠n nh·∫≠p h·ªçc:</strong> Vui l√≤ng x√°c nh·∫≠n nh·∫≠p h·ªçc theo h∆∞·ªõng d·∫´n tr√™n website c·ªßa tr∆∞·ªùng trong v√≤ng 7 ng√†y k·ªÉ t·ª´ ng√†y nh·∫≠n email n√†y.</li>
          <li><strong>Enrollment Confirmation:</strong> <li><strong>N·ªôp h·ªì s∆°:</strong> Chu·∫©n b·ªã v√† n·ªôp ƒë·∫ßy ƒë·ªß h·ªì s∆° nh·∫≠p h·ªçc theo y√™u c·∫ßu.</li>
          <li><strong>Document Submission:</strong> Prepare and submit all required enrollment documents.</li>
          <li><strong>H·∫°n ch√≥t:</strong> Vui l√≤ng ki·ªÉm tra th√¥ng b√°o ch√≠nh th·ª©c tr√™n website ƒë·ªÉ bi·∫øt c√°c m·ªëc th·ªùi gian quan tr·ªçng.</li>
          <li><strong>Deadline:</strong> Please check the official announcement on our website for important dates.</li>
        </ul>
      </div>
      
      <div class="contact-info">
        <h4>üìû Th√¥ng tin li√™n h·ªá</h4>
        <div class="contact-item">
          <strong>üìß Email:</strong>
          <span>tuyensinh@utc2.edu.vn</span>
        </div>
        <div class="contact-item">
          <strong>‚òéÔ∏è ƒêi·ªán tho·∫°i:</strong>
          <span>(028) 3512 0808</span>
        </div>
        <div class="contact-item">
          <strong>üè¢ ƒê·ªãa ch·ªâ:</strong>
          <span>Ph√≤ng Tuy·ªÉn sinh, T√≤a nh√† A, Tr∆∞·ªùng ƒê·∫°i h·ªçc</span>
        </div>
        <div class="contact-item">
          <strong>üåê Website:</strong>
          <span>https://utc2.edu.vn</span>
        </div>
      </div>
      
      <div class="signature">
        <p>M·ªôt l·∫ßn n·ªØa, ch√∫c m·ª´ng b·∫°n ƒë√£ tr√∫ng tuy·ªÉn!</p>
        <p><p style="margin-top: 20px;">Tr√¢n tr·ªçng,</p>
        <p><strong>Ban Tuy·ªÉn sinh</strong></p>
        <p style="font-style: italic; color: #666;"></div>
    </div>
    
    <div class="footer">
      <p><strong>‚ö° Email t·ª± ƒë·ªông / Email t? d?ng</strong></p>
      <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng. Vui l√≤ng kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp email n√†y.</p>
      <p><p style="margin-top: 15px; color: #999;">¬© 2026 University Admission System. B?n quy?n thu?c v?.</p>
    </div>
  </div>
</body>
</html>
    `;
  }

  private formatAdmissionMethod(method: string): string {
    const methodMap: Record<string, string> = {
      entrance_exam: 'X√©t tuy·ªÉn theo k·ª≥ thi ƒë·∫ßu v√†o / Entrance Exam',
      high_school_transcript: 'X√©t tuy·ªÉn h·ªçc b·∫° THPT / High School Transcript',
      direct_admission: 'X√©t tuy·ªÉn th·∫≥ng / Direct Admission',
      competency_assessment: 'ƒê√°nh gi√° nƒÉng l·ª±c / Competency Assessment',
      international_exam: 'Ch·ª©ng ch·ªâ qu·ªëc t·∫ø / International Exam',
    };
    return methodMap[method] || method;
  }
}



